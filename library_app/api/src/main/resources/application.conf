ktor {
    deployment {
        port = ${?PORT}
    }

    application {
        modules = [ com.example.app.ApplicationKt.module ]
    }

    database {
        url = ${?DB_URL}
        driver = "org.postgresql.Driver"
        user = ${?DB_USER}
        password = ${?DB_PASSWORD}
        maxPoolSize = 10
    }

    # ← ЭТО САМОЕ ГЛАВНОЕ — должно быть ВНУТРИ блока ktor!
    readOnly = ${?DB_READ_ONLY}
}

# Для /mirror — если задан BASE_PATH, используем его как context path
ktor.deployment.contextPath = ${?BASE_PATH}